<!DOCTYPE html>
<!-- saved from url=(0055)https://www.sammaya.jp/minimatest/2021/11/08/class.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Class | minima test</title>
<meta name="generator" content="Jekyll v3.9.0">
<meta property="og:title" content="Class">
<meta property="og:locale" content="en_US">
<meta name="description" content="layout: post title: “Classを自作する” ?">
<meta property="og:description" content="layout: post title: “Classを自作する” ?">
<meta property="og:url" content="https://www.sammaya.jp/minimatest/2021/11/08/class.html">
<meta property="og:site_name" content="minima test">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2021-11-08T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Class">
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="./style.css"><link type="application/atom+xml" rel="alternate" href="https://www.sammaya.jp/minimatest/feed.xml" title="minima test">
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="https://www.sammaya.jp/minimatest/">minima test</a></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope="" itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Class</h1>
    <p class="post-meta"><time class="dt-published" datetime="2021-11-08T00:00:00+00:00" itemprop="datePublished">
        Nov 8, 2021
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <hr>
<p>layout: post
title: “Classを自作する”
?</p>

<p>クラスの使用例。</p>

<!-- <div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code> -->
<div><div><pre><code>
<span class="c1">'クラス宣言</span>
<span class="k">Class</span> <span class="nc">C_Player</span>
    <span class="c1">'ここでは変数宣言にDimは使えない</span>

    <span class="c1">'パブリックなメンバを宣言</span>
    <span class="k">Public</span> <span class="n">Name</span> <span class="c1">'名前</span>
    
    <span class="c1">'プライベートなメンバを宣言</span>
    <span class="k">Private</span> <span class="n">m_life</span>     <span class="c1">'ライフ</span>
    <span class="k">Private</span> <span class="n">m_max</span>      <span class="c1">'ライフ最大値</span>
    <span class="k">Private</span> <span class="n">m_strength</span> <span class="c1">'攻撃力</span>
    <span class="k">Private</span> <span class="n">m_enemy</span>    <span class="c1">'敵オブジェクト</span>

    <span class="c1">'プロパティへ値の代入を可能にする</span>
    <span class="k">Public</span> <span class="k">Property</span> <span class="nf">Let</span> <span class="n">Strength</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">m_strength</span> <span class="o">=</span> <span class="n">val</span>
        <span class="n">m_life</span> <span class="o">=</span> <span class="n">Int</span><span class="p">(</span><span class="mi">100000</span> <span class="o">/</span> <span class="n">val</span><span class="p">)</span>
        <span class="n">m_max</span> <span class="o">=</span> <span class="n">m_life</span>
    <span class="k">End</span> <span class="k">Property</span>
    
    <span class="c1">'プロパティの値を取得可能にする</span>
    <span class="k">Public</span> <span class="k">Property</span> <span class="nf">Get</span> <span class="n">Strength</span><span class="p">()</span>
        <span class="n">Strength</span> <span class="o">=</span> <span class="n">m_strength</span>
    <span class="k">End</span> <span class="k">Property</span>

    <span class="c1">'プロパティへオブジェクトの代入を可能にする</span>
    <span class="k">Public</span> <span class="k">Property</span> <span class="nf">Set</span> <span class="n">Enemy</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">Set</span> <span class="n">m_enemy</span> <span class="o">=</span> <span class="n">obj</span>
    <span class="k">End</span> <span class="k">Property</span>
    
    <span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Class_Initialize</span><span class="p">()</span>
        <span class="c1">'インスタンス作成時に行いたい処理を記載   </span>
    <span class="k">End</span> <span class="k">Sub</span>
    
    <span class="k">Private</span> <span class="k">Sub</span> <span class="nf">Class_Terminate</span><span class="p">()</span>
        <span class="c1">'インスタンス破棄時に行いたい処理を記載</span>
    <span class="k">End</span> <span class="k">Sub</span>
    
    <span class="c1">'パブリックなSubプロシージャ(メソッド)</span>
    <span class="k">Public</span> <span class="k">Sub</span> <span class="nf">Atack</span><span class="p">()</span>
        <span class="c1">'プロシージャ内ならDimを使える</span>
        <span class="k">Dim</span> <span class="nv">buf</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="n">Int</span><span class="p">(</span><span class="n">m_strength</span> <span class="o">*</span> <span class="n">Rnd</span><span class="p">())</span>
        <span class="n">Msgbox</span> <span class="n">Name</span> <span class="o">&amp;</span> <span class="s">"の攻撃!"</span>
        <span class="n">m_enemy</span><span class="p">.</span><span class="n">Damage</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">Sub</span>
    
    <span class="c1">'パブリックなFunctionプロシージャ(メソッド)</span>
    <span class="k">Public</span> <span class="k">Function</span> <span class="nf">Damage</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="n">m_life</span> <span class="o">=</span> <span class="n">m_life</span> <span class="o">-</span> <span class="n">val</span>
        <span class="k">If</span> <span class="n">m_life</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">Then</span> <span class="n">m_life</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Msgbox</span> <span class="n">Name</span> <span class="o">&amp;</span> <span class="s">"は"</span> <span class="o">&amp;</span> <span class="n">val</span> <span class="o">&amp;</span> <span class="s">"のダメージを受けた"</span> <span class="o">&amp;</span> <span class="n">vbCr</span> <span class="o">&amp;</span> <span class="s">"(´・ω・) HP:"</span> <span class="o">&amp;</span> <span class="n">m_life</span> <span class="o">&amp;</span> <span class="s">"/"</span> <span class="o">&amp;</span> <span class="n">m_max</span>
        <span class="k">If</span> <span class="n">HasDead</span> <span class="k">Then</span>
            <span class="n">Msgbox</span> <span class="n">Name</span> <span class="o">&amp;</span> <span class="s">"は倒れた!"</span> <span class="o">&amp;</span> <span class="n">vbCr</span> <span class="o">&amp;</span> <span class="s">"( -ω-) ｽﾔｧ"</span>
        <span class="k">Else</span>
            <span class="k">Call</span> <span class="n">Atack</span><span class="p">()</span>
        <span class="k">End</span> <span class="k">If</span>
    <span class="k">End</span> <span class="k">Function</span>
    
    <span class="c1">'プライベートなFunctionプロシージャ</span>
    <span class="k">Private</span> <span class="k">Function</span> <span class="nf">HasDead</span><span class="p">()</span>
        <span class="k">If</span> <span class="n">m_life</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">Then</span>
            <span class="n">HasDead</span> <span class="o">=</span> <span class="k">False</span>
        <span class="k">Else</span>
            <span class="n">HasDead</span> <span class="o">=</span> <span class="k">True</span>
        <span class="k">End</span> <span class="k">If</span>
    <span class="k">End</span> <span class="k">Function</span>
    
<span class="k">End</span> <span class="k">Class</span>


<span class="c1">'変数宣言</span>
<span class="k">Dim</span> <span class="nv">P1</span>
<span class="k">Dim</span> <span class="nv">P2</span>

<span class="c1">'インスタンスを作成</span>
<span class="k">Set</span> <span class="n">P1</span> <span class="o">=</span> <span class="k">New</span> <span class="n">C_Player</span>
<span class="k">Set</span> <span class="n">P2</span> <span class="o">=</span> <span class="k">New</span> <span class="n">C_Player</span>

<span class="c1">'プロパティに値を代入</span>
<span class="n">P1</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">"勇者"</span>
<span class="n">P1</span><span class="p">.</span><span class="n">Strength</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">P2</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">"魔王"</span>
<span class="n">P2</span><span class="p">.</span><span class="n">Strength</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1">'プロパティにオブジェクトを代入</span>
<span class="k">Set</span> <span class="n">P1</span><span class="p">.</span><span class="n">Enemy</span> <span class="o">=</span> <span class="n">P2</span>
<span class="k">Set</span> <span class="n">P2</span><span class="p">.</span><span class="n">Enemy</span> <span class="o">=</span> <span class="n">P1</span>

<span class="c1">'乱数ジェネレータを初期化</span>
<span class="n">Randomize</span><span class="p">()</span>

<span class="c1">'戦闘開始</span>
<span class="n">P1</span><span class="p">.</span><span class="n">Atack</span><span class="p">()</span>

<span class="c1">'インスタンスを破棄</span>
<span class="k">Set</span> <span class="n">P1</span> <span class="o">=</span> <span class="k">Nothing</span>
<span class="k">Set</span> <span class="n">P2</span> <span class="o">=</span> <span class="k">Nothing</span>
</code></pre></div></div>

  </div><a class="u-url" href="https://www.sammaya.jp/minimatest/2021/11/08/class.html" hidden=""></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/minimatest/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="https://www.sammaya.jp/minimatest/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/minimatest/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/sammaya164" title="sammaya164"><svg class="svg-icon grey"><use xlink:href="/minimatest/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>



</body></html>