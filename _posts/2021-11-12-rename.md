---
layout: page
title: "ファイル名の頭に日付を加える"
---

ファイルをドラッグ＆ドロップして使う。

```vb
'1ファイルをドラッグ＆ドロップした場合はファイル名変更を実行する
Select Case WScript.Arguments.Count
Case 1
    Call Rename(WScript.Arguments.Item(0))
Case Else
    Msgbox "1ファイルをドラッグ＆ドロップして下さい。"
End Select


'ファイル名変更
Function Rename(sFile)
    Dim fso
    Set fso = CreateObject("Scripting.FileSystemObject")
  
    Dim file
    If fso.FileExists(sFile) Then
        Set file = fso.GetFile(sFile)
    ElseIf fso.FolderExists(sFile) Then
        Set file = fso.GetFolder(sFile)
    End If

    Dim head
    head = GetDateString() '6桁の日付

  date_6 = Right(Replace(Date(),"/",""),6)
  ' ファイル名
  name = fso.GetFileName(FilePath)
  ' ファイル名変更を実行
  ' 3番目の引数はファイル名の重複を避けるための枝番。
  Call rename_file(parent, date_6, 1, name)
  Set fso = Nothing
End Function


Function GetDateString()

End Fun

' ファイル名変更
Function rename_file(parent, head, i_branch, name)
 parent = fso.GetParentFolderName(FilePath)
  If Right(parent,1) <> "¥" then
    parent = parent & "¥"
 


 Dim fso, fName1, fName2
  ' 変更前の名前
  fName1 = parent & name
  ' 変更後の名前
  fName2 = parent & head & "-" & i_branch & "_" & name
  Set fso = CreateObject("Scripting.FileSystemObject")
  If fso.FileExists(fName2) then
    ' 同じ名前のファイルが既に存在するなら
    ' 枝番を1増やしてrename_fileを再起呼び出し
    Call rename_file(parent, head, i_branch+1, name)
  Else
    ' 同じ名前のファイルが存在しないならファイル名を変更
    Call fso.MoveFile(fName1, fName2)
  End If
  Set fso = Nothing
End Function
```
