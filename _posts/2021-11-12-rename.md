---
layout: post
title: "ファイル名の頭に日付を加える"
---

ファイルをドラッグ＆ドロップしてファイル名を変更する。

フォルダ名も変更できる。

```vb
'1ファイルをドラッグ＆ドロップした場合はファイル名変更を実行する
Select Case WScript.Arguments.Count
Case 1
    Call Rename(WScript.Arguments.Item(0))
Case Else
    Msgbox "1ファイルをドラッグ＆ドロップして下さい。"
End Select


'ファイル名変更
Function Rename(sPath)
    Dim fso
    Set fso = CreateObject("Scripting.FileSystemObject")
  
    Dim f
    'ファイルオブジェクトまたはフォルダオブジェクトを取得する
    If fso.FileExists(sPath) Then
        Set f = fso.GetFile(sPath)
    ElseIf fso.FolderExists(sPath) Then
        Set f = fso.GetFolder(sPath)
    End If
    
    Dim head
    head = GetDateString() '6桁の日付

    'ファイル名を変更
    Call pr_Rename(f, head, 1) '3番目の引数はファイル名の重複を避けるための枝番

    '終了処理
    Set fso = Notging
    Set f   = Nothing
End Function


'6桁の日付を返す
Function GetDateString()
    Dim buf
    '使用者が数字を入力する
    buf = Inputbox("何日前の日付にしますか", 0)
    
    '数字でない場合やキャンセルボタンが押された場合は終了
    If buf = "" Then WScript.Quit()
    If Not IsNumeric(buf) Then WScript.Quit()

    '数字として扱う
    buf = CLng(buf)

    GetDateString = Right(Replace(Date() - buf, "/", ""), 6)
End Function


'ファイル名変更_再帰処理用
Function pr_Rename()
 parent = fso.GetParentFolderName(FilePath)
  If Right(parent,1) <> "¥" then
    parent = parent & "¥"
 


 Dim fso, fName1, fName2
  ' 変更前の名前
  fName1 = parent & name
  ' 変更後の名前
  fName2 = parent & head & "-" & i_branch & "_" & name
  Set fso = CreateObject("Scripting.FileSystemObject")
  If fso.FileExists(fName2) then
    ' 同じ名前のファイルが既に存在するなら
    ' 枝番を1増やしてrename_fileを再起呼び出し
    Call rename_file(parent, head, i_branch+1, name)
  Else
    ' 同じ名前のファイルが存在しないならファイル名を変更
    Call fso.MoveFile(fName1, fName2)
  End If
  Set fso = Nothing
End Function
```
