---
layout: post
title: "ファイル名、パス名を取得する"
---

FileSystemObjectのファイル名、パス名を返すメソッド。

|メソッド|説明|
|---|---|
|GetAbsolutePathName()|完全なパス名を返す|
|GetBaseName()|拡張子を除いたファイル名を返す|
|GetExtensionName()|拡張子を返す|
|GetFileName()|ファイル名を返す|
|GetDriveName()|ドライブ名を返す|
|GetParentFolderName()|親フォルダ名を返す|


Dim fso, FileName
Set fso = CreateObject("Scripting.FileSystemObject")
' ファイル名
FileName = "C:¥Script¥Test.txt"
' ファイルが存在するとき各種ファイル名、パス名を返す
If fso.FileExists(FileName) then
  MsgBox _

  fso.GetAbsolutePathName(FileName) & vbCr & _
  fso.GetBaseName(FileName) & vbCr & _
  fso.GetExtensionName(FileName) & vbCr & _
  fso.GetFileName(FileName) & vbCr & _
  fso.GetDriveName(FileName) & vbCr & _
  fso.GetParentFolderName(FileName)
Else
  MsgBox "ファイルが存在しません"
End If

 

結果

C:¥Script¥Test.txt

Test

txt

Test.txt

C:

C:¥Script

 

上の例ではFileNameを絶対パスで指定しているが

FileName = "Test.txt" と変えた場合、結果は

C:¥Script¥Test.txt

Test

txt

Test.txt

 

 

となって、ドライブ名、親フォルダ名が表示されない。

（Test.txtはスクリプトと同じフォルダに置く）
