---
layout: post
title: "ファイル名、パス名を取得する"
---

## FileSystemObjectのファイル名、パス名を返すメソッド

使用例：

|メソッド|説明|
|---|---|
|GetAbsolutePathName()|フルパスを返す|
|GetBaseName()|拡張子を除いたファイル名を返す|
|GetExtensionName()|拡張子を返す|
|GetFileName()|ファイル名を返す|
|GetDriveName()|ドライブ名を返す|
|GetParentFolderName()|親フォルダ名を返す|

```vb
Dim fso, path
Set fso = CreateObject("Scripting.FileSystemObject")

'絶対パスで指定した場合
path = "C:¥Script¥test.txt"
Msgbox fso.GetAbsolutePathName(path) 'C:¥Script¥test.txt
Msgbox fso.GetBaseName(path) 'test
Msgbox fso.GetExtensionName(path) 'txt
Msgbox fso.GetFileName(path) 'test.txt
Magbox fso.GetDriveName(path) 'C:
Msgbox fso.GetParentFolderName(path) 'C:¥Script

'ファイル名で指定した場合
path = "test.txt"
Msgbox fso.GetAbsolutePathName(path) 'C:¥Script¥test.txt
Msgbox fso.GetBaseName(path) 'test
Msgbox fso.GetExtensionName(path) 'txt
Msgbox fso.GetFileName(path) 'test.txt
Magbox fso.GetDriveName(path) '
Msgbox fso.GetParentFolderName(path) '
```

下側の例ではドライブ名、親フォルダ名が表示されない。

## WScriptオブジェクトのファイル名、パス名を返すプロパティ

|プロパティ|説明|
|---|---|
|ScriptName|スクリプトファイルのファイル名|
|ScriptFullName|スクリプトファイルのフルパス|

使用例：

```vb
Msgbox WScript.ScriptName
Msgbox WScript.ScriptFullName
```

## 特殊フォルダのパス

WshShellオブジェクト配下のSpecialFoldersコレクションから特殊フォルダのパスを取得できる。

```vb
Dim col
Set col = CreateObject("WScript.Shell").SpecialFolders

Msgbox col(0)                 'C:\Users\Public\Desktop
Msgbox col("AllUsersDesktop") 'C:\Users\Public\Desktop
```

|数値|指定名|説明|
|---|---|---|
|0|AllUsersDesktop|全ユーザ共通のデスクトップ|
|1|AllUsersStartMenu|全ユーザ共通のスタートメニュー|
|2|AllUsersPrograms|全ユーザ共通のスタートメニューのプログラムフォルダ|
|3|AllUsersStartup|全ユーザ共通のスタートアップフォルダ|
|4|Desktop|デスクトップ|
|5|AppData|アプリケーションデータ|
|6|PrintHood|プリンタ|
|7|Templates|テンプレート|
|8|Fonts|フォント|
|9|NetHood|ネットワーク|
|10|Desktop|デスクトップ|
|11|StartMenu|スタートメニュー|
|12|SendTo|送るフォルダ|
|13|Recent|最近使ったファイル|
|14|Startup|スタートアップフォルダ|
|15|Favorites|お気に入り|
|16|MyDocuments|マイドキュメント|
|17|Programs|プログラムフォルダ|

デスクトップが2つ(4と10)あるのは謎。

